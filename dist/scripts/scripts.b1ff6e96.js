"use strict";angular.module("flickrConsumerApp",["ngAnimate","ngAria","ngCookies","ngRoute","ngStorage"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl",controllerAs:"main"}).otherwise({redirectTo:"/"})}]),angular.module("flickrConsumerApp").controller("MainCtrl",["$http","flickrData",function(a,b){this.data=b}]),angular.module("flickrConsumerApp").service("flickrData",["$http","FlickrItem","favorites","flickrFeedUrl",function(a,b,c,d){this.items=[],this.populateItems=function(a){_.isArray(a)&&a.forEach(function(a){this.items.push(new b(a))}.bind(this))},this.populateItems(_.clone(c.getList())),a.jsonp(d).then(function(a){this.populateItems(a.data.items)}.bind(this))}]),angular.module("flickrConsumerApp").factory("FlickrItem",["favorites",function(a){var b=function(b){_.extend(this,b),this.toggleFavorite=function(){this.isFavorite=!this.isFavorite,b.isFavorite=this.isFavorite,a.addOrRemove(b)}};return b}]),angular.module("flickrConsumerApp").service("favorites",["$localStorage",function(a){var b=a.flickrFavorites||{};b.list=b.list||[],this.save=function(){return a.flickrFavorites=b,this},this.getList=function(){return b.list},this.add=function(a){return b.list.push(a),this.save()},this.remove=function(a){var c=b.list.indexOf(a);return c>-1&&b.list.splice(c,1),this.save()},this.addOrRemove=function(a){var c=b.list.indexOf(a),d=c>-1?"remove":"add";return this[d](a)}}]),angular.module("flickrConsumerApp").constant("flickrFeedUrl","https://api.flickr.com/services/feeds/photos_public.gne?format=json&jsoncallback=JSON_CALLBACK"),angular.module("flickrConsumerApp").run(["$templateCache",function(a){a.put("views/main.html",'<h1 class="header">The "Random Flickr photos that you may enjoy™" app</h1> <p> Tap/select/click on a photo that you want to mark as your favourite. When you refresh the app, all your saved photos will be here. Sweet! </p> <p ng-hide="main.data.items.length">Loading…</p> <ul class="list"> <li class="list__item" ng-repeat="item in main.data.items"> <img class="list__image" title="{{ item.title }}" ng-src="{{ item.media.m }}" ng-click="item.toggleFavorite()" ng-class="{\'list__image--selected\': item.isFavorite}"> </li> </ul>')}]);